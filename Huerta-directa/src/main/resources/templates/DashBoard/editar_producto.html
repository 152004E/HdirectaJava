<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editar Producto - Huerta Directa</title>
    <link rel="icon" type="image/png" href="/images/logo_huerta.png" />
    <link rel="stylesheet" href="/CSS/StyleDashBoardd.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="editar-container">
      <h1><i class="fas fa-edit"></i> EDITAR PRODUCTO</h1>

      <!-- Mensajes de éxito o error -->
      <div
        th:if="${success}"
        class="alert alert-success alert-dismissible fade show"
        role="alert"
      >
        <i class="fas fa-check-circle"></i> <span th:text="${success}"></span>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
        ></button>
      </div>

      <div
        th:if="${error}"
        class="alert alert-danger alert-dismissible fade show"
        role="alert"
      >
        <i class="fas fa-exclamation-circle"></i>
        <span th:text="${error}"></span>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
        ></button>
      </div>

      <!-- Formulario de edición -->
      <form
        th:action="@{/actualizar_producto/{id}(id=${producto.idProduct})}"
        method="post"
        th:object="${producto}"
      >
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="nameProduct" class="form-label"
              >Nombre del Producto</label
            >
            <input
              type="text"
              class="form-control"
              id="nameProduct"
              th:field="*{nameProduct}"
              required
            />
          </div>

          <div class="col-md-6 mb-3">
            <label for="price" class="form-label">Precio (COP)</label>
            <input
              type="number"
              step="0.01"
              class="form-control"
              id="price"
              th:field="*{price}"
              required
            />
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="category" class="form-label">Categoría</label>
            <select
              class="form-select"
              id="category"
              th:field="*{category}"
              required
            >
              <option value="">Seleccione una categoría</option>
              <option value="frutas">Frutas</option>
              <option value="verduras-hortalizas">Verduras y Hortalizas</option>
              <option value="lacteos">Lácteos</option>
              <option value="carnes-proteinas">Carnes y Proteínas</option>
              <option value="cereales-granos">Cereales y Granos</option>
              <option value="legumbres-secas">Legumbres Secas</option>
              <option value="productos-organicos">Productos Orgánicos</option>
              <option value="hierbas-especias">Hierbas y Especias</option>
              <option value="miel-derivados">Miel y Derivados</option>
              <option value="procesados-artesanales">
                Procesados Artesanales
              </option>
              <option value="bebidas-naturales">Bebidas Naturales</option>
              <option value="plantas-semillas">Plantas y Semillas</option>
              <option value="cajas-combos">Cajas Mixtas o Combos</option>
            </select>
          </div>

          <div class="col-md-6 mb-3">
            <label for="unit" class="form-label">Unidad de Medida</label>
            <select class="form-select" id="unit" th:field="*{unit}" required>
              <option value="">Seleccione una medida</option>
              <option value="kg">Kilogramos (kg)</option>
              <option value="g">Gramos (g)</option>
              <option value="lb">Libras (lb)</option>
              <option value="unidad">Unidad (u)</option>
              <option value="litro">Litros (L)</option>
              <option value="ml">Mililitros (ml)</option>
              <option value="docena">Docena</option>
              <option value="paq">Paquete</option>
              <option value="caja">Caja</option>
              <option value="otro">Otro</option>
            </select>
          </div>
        </div>

        <div class="mb-3">
          <label for="descriptionProduct" class="form-label">Descripción</label>
          <textarea
            class="form-control"
            id="descriptionProduct"
            rows="4"
            th:field="*{descriptionProduct}"
            required
          ></textarea>
        </div>

        <div class="mb-3">
          <label for="imageProduct" class="form-label"
            >Nombre de la Imagen</label
          >
          <input
            type="text"
            class="form-control"
            id="imageProduct"
            th:field="*{imageProduct}"
            placeholder="Ej: producto.jpg"
            readonly
          />
          <small class="text-muted">
            <i class="fas fa-info-circle"></i>
            La imagen actual se mantiene. Para cambiarla, contacte al
            administrador.
          </small>
        </div>

        <!-- Campos ocultos -->
        <input type="hidden" th:field="*{idProduct}" />
        <input type="hidden" th:field="*{publicationDate}" />
        <input type="hidden" th:field="*{userId}" />

        <!-- Botones de acción -->
        <div class="d-flex justify-content-between mt-4">
          <a href="/Dashboardd" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Cancelar
          </a>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save"></i> Guardar Cambios
          </button>
        </div>
      </form>
      <!-- Modal vista previa -->
      <div
        id="modalVistaPrevia"
        class="hidden fixed inset-0 bg-black bg-opacity-50 z-[9999] flex justify-center items-center"
      >
        <div
          class="bg-white p-5 rounded-2xl w-[400px] shadow-xl animate-[fadeIn_0.3s_ease-in-out]"
        >
          <div class="text-center flex flex-col items-center">
            <h3 class="text-xl font-semibold mb-3">Vista previa</h3>
            <img
              id="prev-imagen"
              class="w-[200px] rounded-lg mb-4"
              src="../images/ImgenAgregarProducto1.png"
              alt="Vista previa"
            />
            <div class="text-center space-y-2 text-sm">
              <h3 id="prev-nombre" class="font-semibold text-lg">
                Nombre del producto
              </h3>
              <p id="prev-precio" class="text-[#8dc84b] font-medium">
                Precio $0.00
              </p>
              <p id="prev-unidad">Medida: —</p>
              <p id="prev-categoria">Categoría: —</p>
              <p id="prev-descripcion">Descripción: —</p>
            </div>
            <button
              class="mt-4 bg-[#8dc84b] hover:bg-[#004d00] text-white px-8 py-2 rounded-md font-semibold transition-all"
              id="cerrarModal"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Auto-ocultar alertas después de 5 segundos
      setTimeout(() => {
        const alerts = document.querySelectorAll(".alert");
        alerts.forEach((alert) => {
          alert.style.transition = "opacity 0.5s";
          alert.style.opacity = "0";
          setTimeout(() => alert.remove(), 500);
        });
      }, 5000);
    </script>
  </body>
</html>
