<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agrega tu producto || Huerta Directa</title>
    <link rel="icon" type="image/png" href="/images/logo_huerta.png" />

    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Iconos de Google (Material Symbols) -->
<link
  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
  rel="stylesheet"
/>

    <!-- Tailwind CSS -->
    <link href="/CSS/output.css" rel="stylesheet" />
  </head>

  <body class="min-h-screen flex flex-col font-[Poppins] bg-[#f7efd8] text-[#333]">
    <!-- Nav -->
    <div th:replace="fragments/navPagina :: navPagina"></div>

    <!-- Contenedor principal -->
    <div class="flex justify-center items-center h-[800px]  bg-[#f7efd8]">
      <form
        class="bg-white w-[700px] p-6 rounded-xl shadow-md"
        action="http://localhost:8085/api/products/create"
        method="POST"
        enctype="multipart/form-data"
      >
        <!-- T√≠tulo -->
        <div class="flex justify-center mb-4">
          <h2 class="text-2xl font-semibold uppercase tracking-wide">
            Registro de Producto
          </h2>
        </div>
        <hr class="border border-[#8dc84b] mb-4" />

        <!-- Nombre -->
        <div class="mb-4">
          <label for="nombre" class="block text-sm font-medium mb-1 text-black"
            >Nombre del producto:</label
          >
          <input
            type="text"
            id="nombre"
            name="nombre"
            required
            class="w-full border border-[#8dc84b] rounded-md px-4 py-2 focus:outline-none focus:border-[#004d00] focus:ring-2 focus:ring-[#004d00]/40 transition-all text-sm"
          />
        </div>

        <hr class="border border-[#8dc84b] mb-4" />

        <!-- Precio, unidad y categor√≠a -->
        <div class="flex flex-wrap gap-4 mb-4">
          <div class="flex-1 min-w-[150px]">
            <label for="precio" class="block text-sm font-medium mb-1 text-black"
              >Precio:</label
            >
            <input
              type="number"
              id="precio"
              name="precio"
              step="0.01"
              required
              class="w-full border border-[#8dc84b] rounded-md px-4 py-2 focus:outline-none focus:border-[#004d00] focus:ring-2 focus:ring-[#004d00]/40 transition-all text-sm"
            />
          </div>

          <div class="flex-1 min-w-[150px]">
            <label for="unidad" class="block text-sm font-medium mb-1 text-black"
              >Unidad de medida:</label
            >
            <select
              id="unidad"
              name="unidad"
              class="w-full border border-[#8dc84b] rounded-md px-4 py-2 focus:outline-none focus:border-[#004d00] focus:ring-2 focus:ring-[#004d00]/40 transition-all text-sm"
            >
              <option value="">Medida</option>
              <option value="kg">Kilogramos (kg)</option>
              <option value="g">Gramos (g)</option>
              <option value="lb">Libras (lb)</option>
              <option value="unidad">Unidad (u)</option>
              <option value="litro">Litros (L)</option>
              <option value="ml">Mililitros (ml)</option>
              <option value="docena">Docena</option>
              <option value="paq">Paquete</option>
              <option value="caja">Caja</option>
              <option value="otro">Otro</option>
            </select>
          </div>

          <div class="flex-1 min-w-[150px]">
            <label class="block text-sm font-medium mb-1 text-black"
              >Categor√≠a:</label
            >
            <select
              class="w-full border border-[#8dc84b] rounded-md px-4 py-2 focus:outline-none focus:border-[#004d00] focus:ring-2 focus:ring-[#004d00]/40 transition-all text-sm"
              name="categoria-producto"
              id="categoria-producto"
            >
              <option value="">Seleccione la categor√≠a</option>
              <option value="frutas">Frutas</option>
              <option value="verduras-hortalizas">Verduras y Hortalizas</option>
              <option value="lacteos">L√°cteos</option>
              <option value="carnes-proteinas">Carnes y Prote√≠nas</option>
              <option value="cereales-granos">Cereales y Granos</option>
              <option value="legumbres-secas">Legumbres Secas</option>
              <option value="productos-organicos">Productos Org√°nicos</option>
              <option value="hierbas-especias">Hierbas y Especias</option>
              <option value="miel-derivados">Miel y Derivados</option>
              <option value="procesados-artesanales">
                Procesados Artesanales
              </option>
              <option value="bebidas-naturales">Bebidas Naturales</option>
              <option value="plantas-semillas">Plantas y Semillas</option>
              <option value="cajas-combos">Cajas Mixtas o Combos</option>
              <option value="otros">Otros</option>
            </select>
          </div>
        </div>

        <hr class="border border-[#8dc84b] mb-4" />

        <!-- Imagen -->
        <div class="flex items-center justify-between mb-4 flex-wrap gap-2">
          <label for="imagen" class="text-sm font-medium text-black"
            >Imagen del producto:</label
          >
          <input
            type="file"
            id="imagen"
            name="image_product"
            accept="image/*"
            required
            hidden
          />
          <label
            for="imagen"
            class="bg-[#8dc84b] text-white px-4 py-2 rounded-md font-semibold cursor-pointer hover:bg-[#6ca52a] transition-all"
          >
            üìÅ Seleccionar imagen
          </label>
          <span id="file-name" class="text-[#8dc84b] font-medium text-sm"
            >Ning√∫n archivo seleccionado</span
          >
        </div>

        <hr class="border border-[#8dc84b] mb-4" />

        <!-- Descripci√≥n -->
        <div class="mb-4">
          <label for="descripcion" class="block text-sm font-medium mb-1 text-black"
            >Descripci√≥n:</label
          >
          <textarea
            id="descripcion"
            name="descripcion"
            rows="4"
            class="w-full border border-[#8dc84b] rounded-md px-4 py-2 focus:outline-none focus:border-[#004d00] focus:ring-2 focus:ring-[#004d00]/40 transition-all text-sm"
            required
          ></textarea>
        </div>

        <!-- Botones -->
        <!--   <div
          class="container-button d-flex align-items-center justify-content-center gap-3"
        >
        <a
            class="btn-2 d-flex justify-content-center align-items-center botonIcon"
            th:href="@{/index}"
            >volver
            <span class="material-symbols-outlined flecha"> arrow_back </span></a
          >
          
          <button type="button" id="btn-visualizar" class="btn-2 botonIcon icono">
            Visualizar
            <span id="passwordOjo" class="material-symbols-outlined"
              >visibility</span
            >
          </button>
          
          <button type="submit" class="btn-2 botonIcon">
            Agregar
            <span class="material-symbols-outlined"> arrow_forward </span>
          </button>
        </div> -->
        <div class="flex justify-between items-center">
          <a
            th:href="@{/index}"
            class="relative flex items-center justify-center gap-5 bg-[#8dc84b] hover:bg-[#004d00] text-white font-semibold text-sm uppercase tracking-wider px-8 py-3 rounded-md transition-all"
          >
            <span class="material-symbols-outlined flecha"> arrow_back </span>
            Volver
          </a>

          <button
            type="button"
            id="btn-visualizar"
            class="relative flex items-center justify-center !w[300px]  bg-[#8dc84b] hover:bg-[#004d00] text-white font-semibold text-sm uppercase tracking-wider px-8 py-3  rounded-md transition-all"
          >
            Visualizar
            <span
              id="passwordOjo"
              class="material-symbols-outlined absolute right-5 text-white"
              >visibility</span
            >
          </button>

          <button
            type="submit"
            class="relative flex items-center justify-center gap-5 bg-[#8dc84b] hover:bg-[#004d00] text-white font-semibold text-sm uppercase tracking-wider px-8 py-3 rounded-md transition-all"
          >
            Agregar
            <span class="material-symbols-outlined absolute !right-0    text-white"
              >arrow_forward</span
            >
          </button>
        </div>
      </form>

      <!-- Modal vista previa -->
      <div
        id="modalVistaPrevia"
        class="hidden fixed inset-0 bg-black bg-opacity-50 z-[9999] flex justify-center items-center"
      >
        <div
          class="bg-white p-5 rounded-2xl w-[400px] shadow-xl animate-[fadeIn_0.3s_ease-in-out]"
        >
          <div class="text-center flex flex-col items-center">
            <h3 class="text-xl font-semibold mb-3">Vista previa</h3>
            <img
              id="prev-imagen"
              class="w-[200px] rounded-lg mb-4"
              src="../images/ImgenAgregarProducto1.png"
              alt="Vista previa"
            />
            <div class="text-center space-y-2 text-sm">
              <h3 id="prev-nombre" class="font-semibold text-lg">
                Nombre del producto
              </h3>
              <p id="prev-precio" class="text-[#8dc84b] font-medium">
                Precio $0.00
              </p>
              <p id="prev-unidad">Medida: ‚Äî</p>
              <p id="prev-categoria">Categor√≠a: ‚Äî</p>
              <p id="prev-descripcion">Descripci√≥n: ‚Äî</p>
            </div>
            <button
              class="mt-4 bg-[#8dc84b] hover:bg-[#004d00] text-white px-8 py-2 rounded-md font-semibold transition-all"
              id="cerrarModal"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>

    <div th:replace="fragments/footer :: footer"></div>

    <script>
      const inputImagen = document.getElementById("imagen");
      const fileNameSpan = document.getElementById("file-name");

      inputImagen.addEventListener("change", function () {
        fileNameSpan.textContent =
          inputImagen.files.length > 0
            ? inputImagen.files[0].name
            : "Ning√∫n archivo seleccionado";
      });

      const btnVisualizar = document.getElementById("btn-visualizar");
      const modal = document.getElementById("modalVistaPrevia");
      const cerrarBtn = document.getElementById("cerrarModal");

      const nombre = document.querySelector('[name="nombre"]');
      const precio = document.querySelector('[name="precio"]');
      const categoria = document.querySelector('[name="categoria-producto"]');
      const descripcion = document.querySelector('[name="descripcion"]');
      const imagen = document.querySelector('[name="image_product"]');
      const unidad = document.querySelector('[name="unidad"]');

      const prevNombre = document.getElementById("prev-nombre");
      const prevPrecio = document.getElementById("prev-precio");
      const prevCategoria = document.getElementById("prev-categoria");
      const prevDescripcion = document.getElementById("prev-descripcion");
      const prevImagen = document.getElementById("prev-imagen");
      const prevUnidad = document.getElementById("prev-unidad");

      btnVisualizar.addEventListener("click", () => {
        prevNombre.textContent = nombre.value || "Nombre del producto";
        prevPrecio.textContent = precio.value
          ? `Precio: $${precio.value}`
          : "Precio: $0.00";
        prevUnidad.textContent =
          "Medida: " + (unidad.options[unidad.selectedIndex].text || "‚Äî");
        prevCategoria.textContent =
          "Categor√≠a: " +
          (categoria.options[categoria.selectedIndex].text || "‚Äî");
        prevDescripcion.textContent =
          "Descripci√≥n: " + (descripcion.value || "Descripci√≥n del producto");

        const file = imagen.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => (prevImagen.src = e.target.result);
          reader.readAsDataURL(file);
        } else {
          prevImagen.src = "../images/ImgenAgregarProducto1.png";
        }

        modal.classList.remove("hidden");
      });

      cerrarBtn.addEventListener("click", () => {
        modal.classList.add("hidden");
      });

      window.addEventListener("click", (e) => {
        if (e.target === modal) modal.classList.add("hidden");
      });
    </script>
  </body>
</html>
